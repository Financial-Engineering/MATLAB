

RBCti=[(datenum(2004,5,21)-datenum(2002,11,21))/365;(datenum(2004,11,21)-datenum(2002,11,21))/365];
RBCtf=(datenum(2003,11,21)-datenum(2002,11,21))/365;

RBCrd1=(0.0493452-0.0485890)/(2-1.093151)*(RBCti(1)-1.090351)+0.0485890;
RBCrd2=(0.0505254-0.0493452)/(3-2)*(RBCti(2)-2)+0.0493452;

RBCrd=[RBCrd1;RBCrd2];

RBCrdtf=(0.0485890-0.0489871)/(1.093151-0.846575)*(RBCtf-0.846575)+0.0489871;

RBCrd=(RBCrd.*RBCti-RBCrdtf*RBCtf)./(RBCti-RBCtf);

RBCrfUSD1=(0.0492323-0.0492850)/(1.61369863-1.34520548)*(RBCti(1)-1.34520548)+0.0492850;
RBCrfUSD2=(0.0496318-0.0493781)/(2.11232877-1.8630137)*(RBCti(2)-1.8630137)+0.0493781;

RBCrfUSD=[RBCrfUSD1;RBCrfUSD2];

RBCrfUSDtf=(0.0492416-0.0496890)/(1.09589041-0.84657534)*(RBCtf-0.84657534)+0.0496890;

RBCrfUSD=(RBCrfUSD.*RBCti-RBCrfUSDtf*RBCtf)./(RBCti-RBCtf);

RBCrfDEM1=(0.0343631-0.0343238)/(1.50411-1.263014)*(RBCti(1)-1.263014)+0.0343238;
RBCrfDEM2=(0.0348840-0.0344211)/(2.010959-1.761644)*(RBCti(2)-1.761644)+0.0348840;

RBCrfDEM=[RBCrfDEM1;RBCrfDEM2];

RBCrfDEMtf=(0.0342658-0.0347395)/(1.005479-0.50137)*(RBCtf-0.50137)+0.0347395;

RBCrfDEM=(RBCrfDEM.*RBCti-RBCrfDEMtf*RBCtf)./(RBCti-RBCtf);

RBCrfGBP1=(0.0600125-0.0606432)/(1.50137-1.254795)*(RBCti(1)-1.254795)+0.0606432;
RBCrfGBP2=(0.0593720-0.0595603)/(2.010959-1.753425)*(RBCti(2)-1.753425)+0.0595603;

RBCrfGBP=[RBCrfGBP1;RBCrfGBP2];

RBCrfGBPtf=(0.0615559-0.0644571)/(1.00274-0.49863)*(RBCtf-0.49863)+0.0644571;

RBCrfGBP=(RBCrfGBP.*RBCti-RBCrfGBPtf*RBCtf)./(RBCti-RBCtf);

RBCrfFRF1=(0.0345557-0.0343729)/(1.50411-1.263014)*(RBCti(1)-1.263014)+0.0343729;
RBCrfFRF2=(0.0353478-0.0347779)/(2.010959-1.761644)*(RBCti(2)-1.761644)+0.0347779;

RBCrfFRF=[RBCrfFRF1;RBCrfFRF2];

RBCrfFRFtf=(0.0341891-0.0346619)/(1.005479-0.50137)*(RBCtf-0.50137)+0.0346619;

RBCrfFRF=(RBCrfFRF.*RBCti-RBCrfFRFtf*RBCtf)./(RBCti-RBCtf);

RBCrfJPY1=(0.0072638-0.0086124)/(1.50411-1.263014)*(RBCti(1)-1.263014)+0.0086124;
RBCrfJPY2=(0.0045299-0.0056141)/(2.010959-1.761644)*(RBCti(2)-1.761644)+0.0056141;

RBCrfJPY=[RBCrfJPY1;RBCrfJPY2];

RBCrfJPYtf=(0.0099502-0.0095541)/(1.005479-0.50137)*(RBCtf-0.50137)+0.0095541;

RBCrfJPY=(RBCrfJPY.*RBCti-RBCrfJPYtf*RBCtf)./(RBCti-RBCtf);

RBCrfCHF1=(0.0178600-0.0175062)/(1.50411-1.263014)*(RBCti(1)-1.263014)+0.0175062;
RBCrfCHF2=(0.0187330-0.0182822)/(2.010959-1.761644)*(RBCti(2)-1.761644)+0.0182822;

RBCrfCHF=[RBCrfCHF1;RBCrfCHF2];

RBCrfCHFtf=(0.0171522-0.0155087)/(1.005479-0.50137)*(RBCtf-0.50137)+0.0155087;

RBCrfCHF=(RBCrfCHF.*RBCti-RBCrfCHFtf*RBCtf)./(RBCti-RBCtf);

RBCrfAUD1=(0.0474467-0.0471987)/(1.50411-1.263014)*(RBCti(1)-1.263014)+0.0471987;
RBCrfAUD2=(0.0480951-0.0477514)/(2.010959-1.761644)*(RBCti(2)-1.761644)+0.0477514;

RBCrfAUD=[RBCrfAUD1;RBCrfAUD2];

RBCrfAUDtf=(0.0469408-0.0471410)/(1.005479-0.50137)*(RBCtf-0.50137)+0.0471410;

RBCrfAUD=(RBCrfAUD.*RBCti-RBCrfAUDtf*RBCtf)./(RBCti-RBCtf);

S=[4639.00;5464.00;3560.00;14075.00;1126.00;6737.00;2708.00;346.00];
Stf=[];
wa=[0.0833;0.0834;0.0833;0.1667;0.1667;0.0833;0.1666;0.1667];
wf=1/2*ones(2,1);
m=0;
Spg=[];
sigS=[0.29*ones(1,2);0.28*ones(1,2);0.295*ones(1,2);0.30*ones(1,2);0.29*ones(1,2);0.295*ones(1,2);0.285*ones(1,2);0.28*ones(1,2)];
rhoij=[1 0.5 0.55 0.45 0.35 0.45 0.55 0.45;0.5 1 0.5 0.3 0.35 0.45 0.45 0.45;0.55 0.5 1 0.25 0.45 0.45 0.35 0.45;0.45 0.3 0.25 1 0.1 0.45 0.35 0.25;0.35 0.35 0.45 0.1 1 0.45 0.25 0.75;0.45 0.45 0.45 0.45 0.45 1 0.45 0.45;0.55 0.45 0.35 0.35 0.25 0.45 1 0.35;0.45 0.45 0.45 0.25 0.75 0.45 0.35 1];
rhoi=[-0.15;-0.20;-0.20;0;0;-0.25;-0.20;1];
r=[RBCrfDEM';RBCrfGBP';RBCrfFRF';RBCrfJPY';RBCrfUSD';RBCrfCHF';RBCrfAUD';RBCrd'];
b=r-[zeros(1,2);0.026*ones(1,2);0.0155*ones(1,2);0.0105*ones(1,2);0.0145*ones(1,2);0.0095*ones(1,2);0.0355*ones(1,2);0.0213*ones(1,2)];
ti = RBCti(:);
t=0;
T=ti(length(RBCrd));
sigX=[0.13;0.125;0.125;0.15;0.06;0.125;0.135;0];
rhoi=[-0.15;-0.20;-0.20;0;0;-0.25;-0.20;1];
df=exp(-RBCrd(length(RBCrd))*(T-t));
tf=RBCtf;
lambda=1.5*ones(8,1);
Stf=S;
